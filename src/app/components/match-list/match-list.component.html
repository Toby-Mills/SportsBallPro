<div class="match-list-container">
  <!-- Navigation Controls (shown when in carousel mode) -->
  <div class="matches-nav" *ngIf="watchedMatches.length > 0 && useCarouselView">
    <button class="nav-arrow" (click)="scrollLeft()" [disabled]="!canScrollLeft" aria-label="Previous">
      <span class="material-icons">chevron_left</span>
    </button>
    
    <div class="dots">
      <span *ngFor="let match of watchedMatches; let i = index"
            class="dot"
            [class.active]="i >= currentScrollIndex && i < currentScrollIndex + visibleMatchCount"
            (click)="scrollToMatch(i)"
            [attr.aria-label]="'Go to match ' + (i + 1)">
      </span>
    </div>
    
    <button class="nav-arrow" (click)="scrollRight()" [disabled]="!canScrollRight" aria-label="Next">
      <span class="material-icons">chevron_right</span>
    </button>
  </div>

  <!-- Refresh Timer (shown when matches exist) -->
  <app-refresh-timer #refreshTimer (timerTriggered)="onRefreshTimer()" *ngIf="watchedMatches.length > 0"></app-refresh-timer>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="watchedMatches.length === 0">
    <img src="assets/logos/SportsBallPro_Ball.png" alt="SportsBallPro" class="large-icon">
    <h2>No matches being watched</h2>
    <p>Add matches to monitor them side-by-side</p>
  </div>

  <!-- Carousel View (Mobile or Desktop with 4+ matches) -->
  <div class="matches-carousel" *ngIf="watchedMatches.length > 0 && useCarouselView" 
       [style.--visible-count]="visibleMatchCount">
      <div class="carousel-track" 
           [style.transform]="'translateX(calc(-' + currentScrollIndex + ' * (100% / ' + visibleMatchCount + ' + ' + carouselGap + ')))'">
        <div class="match-card" 
             [class.highlight]="gameId === highlightedMatchId"
             *ngFor="let gameId of watchedMatches; let i = index">
        <div class="match-card-header">
          <div class="menu-wrapper">
            <button class="icon-btn menu-btn" (click)="toggleMenu(gameId, $event)" title="More options">
              <span class="material-icons">more_vert</span>
            </button>
            <div class="dropdown-menu" *ngIf="openMenus.has(gameId)">
              <button class="menu-item" (click)="onMenuNotifications(gameId, $event)">
                <span class="material-icons">notifications</span>
                <span>Notifications</span>
              </button>
              <button class="menu-item" (click)="onMenuShare(gameId, $event)">
                <span class="material-icons">share</span>
                <span>Share</span>
              </button>
            </div>
          </div>
          <button class="icon-btn close-btn" (click)="removeMatch(gameId)" title="Remove from watch list">
            <span class="material-icons">close</span>
          </button>
        </div>
        
        <app-match-details 
          [gameId]="gameId"
          [showWakeLock]="false">
        </app-match-details>
      </div>
    </div>
  </div>

  <!-- Grid View: Multiple Matches Side-by-Side (Desktop with 1-3 matches) -->
  <div class="matches-grid" *ngIf="watchedMatches.length > 0 && !useCarouselView">
    <div class="match-card" 
         [class.highlight]="gameId === highlightedMatchId"
         *ngFor="let gameId of watchedMatches; let i = index">
      <div class="match-card-header">
        <div class="menu-wrapper">
          <button class="icon-btn menu-btn" (click)="toggleMenu(gameId, $event)" title="More options">
            <span class="material-icons">more_vert</span>
          </button>
          <div class="dropdown-menu" *ngIf="openMenus.has(gameId)">
            <button class="menu-item" (click)="onMenuNotifications(gameId, $event)">
              <span class="material-icons">notifications</span>
              <span>Notifications</span>
            </button>
            <button class="menu-item" (click)="onMenuShare(gameId, $event)">
              <span class="material-icons">share</span>
              <span>Share</span>
            </button>
          </div>
        </div>
        <button class="icon-btn close-btn" (click)="removeMatch(gameId)" aria-label="Remove match">
          <span class="material-icons">close</span>
        </button>
      </div>
      
      <app-match-details 
        [gameId]="gameId"
        [showWakeLock]="false">
      </app-match-details>
    </div>
  </div>
</div>

<!-- Notification Settings Modal -->
<app-notification-settings
  [isVisible]="showNotificationSettings"
  [gameId]="notificationSettingsGameId"
  [teamAName]="notificationSettingsTeamA"
  [teamBName]="notificationSettingsTeamB"
  (close)="closeNotificationSettings()">
</app-notification-settings>
